!function(a,b){function c(b,e){c.counter=c.counter||0,j["whenInViewport"+ ++c.counter]=a.extend({},a.whenInViewport.defaults,e,{$el:b,topOffset:b.offset().top}),h||(h=l(d,0)),h()}function d(){var b=i.scrollTop();a.each(j,function(a,c){b+g>c.topOffset-c.threshold&&(c.context?c.callback.call(c.context,j[a].$el):c.callback(j[a].$el),delete j[a],m.checkRegistry())})}function e(){g=i.height(),a.each(j,function(a,b){j[a].topOffset=b.$el.offset().top})}function f(b,d){"undefined"==typeof g&&(g=i.height()),c(a(b),d),m.checkRegistry()}var g,h,i=b.app&&b.app.$window||a(b),j={},k=100,l=function(a,b){var c=function(){clearTimeout(c.timeout),c.timeout=setTimeout(a,b)};return c},m={namespace:".whenInViewport",setuped:!1,setup:function(){this.setuped||(i.on("scroll"+this.namespace,l(d,k)),i.on("resize"+this.namespace,l(e,k)),this.setuped=!0,g=i.height())},destroy:function(){this.setuped&&i.off(this.namespace),this.setuped=!1},checkRegistry:function(){a.isEmptyObject(j)?this.destroy():this.setup()}};a.extend(f,{setDelayEngine:function(a){return l=a,this},setDelayTimeout:function(a){return k=a,this},destroy:function(){j={},m.destroy()}}),a.whenInViewport=f,a.whenInViewport.defaults={callback:function(){},threshold:0,context:null,setupOnce:!1},a.fn.whenInViewport=function(b,c){return"function"==typeof b&&(b=a.extend({},c,{callback:b})),this.each(function(){b.setupOnce&&!a.data(this,"whenInViewport")?a.data(this,"whenInViewport",new f(this,b)):new f(this,b)})}}(window.jQuery||window.Zepto,window);