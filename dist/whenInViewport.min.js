!function(a,b){function c(b,e){c.counter=c.counter||0,i["whenInViewport"+ ++c.counter]=a.extend({},a.whenInViewport.defaults,e,{$el:b,topOffset:b.offset().top}),d()}function d(){var b=h.scrollTop();a.each(i,function(a,c){b+g>c.topOffset-c.threshold&&(c.context?c.callback.call(c.context,i[a].$el):c.callback(i[a].$el),delete i[a],l.checkRegistry())})}function e(){g=h.height(),a.each(i,function(a,b){i[a].topOffset=b.$el.offset().top})}function f(b,d){"undefined"==typeof g&&(g=h.height()),c(a(b),d),l.checkRegistry()}var g,h=b.app&&b.app.$window||a(b),i={},j=100,k=function(a,b){var c=function(){clearTimeout(c.timeout),c.timeout=setTimeout(a,b)};return c},l={namespace:".whenInViewport",setuped:!1,setup:function(){this.setuped||(h.on("scroll"+this.namespace,k(d,j)),h.on("resize"+this.namespace,k(e,j)),this.setuped=!0,g=h.height())},destroy:function(){this.setuped&&h.off(this.namespace),this.setuped=!1},checkRegistry:function(){a.isEmptyObject(i)?this.destroy():this.setup()}};a.extend(f,{setDelayEngine:function(a){return k=a,this},setDelayTimeout:function(a){return j=a,this},destroy:function(){i={},l.destroy()}}),a.whenInViewport=f,a.whenInViewport.defaults={callback:function(){},threshold:0,context:null,setupOnce:!1},a.fn.whenInViewport=function(b,c){return"function"==typeof b&&(b=a.extend({},c,{callback:b})),this.each(function(){b.setupOnce&&!a.data(this,"whenInViewport")?a.data(this,"whenInViewport",new f(this,b)):new f(this,b)})}}(window.jQuery||window.Zepto,window);